# å¯¹è¯æœç´¢åŠŸèƒ½å®ç°æ€»ç»“

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æˆåŠŸä¸ºåšå®¢å¹³å°çš„å‰ç«¯å®ç°äº†å®Œæ•´çš„å¯¹è¯æœç´¢åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥åœ¨è‡ªå·±çš„å¯¹è¯å†å²ä¸­æœç´¢ç‰¹å®šå…³é”®è¯ï¼Œè·å¾—æ™ºèƒ½çš„æœç´¢ç»“æœå’Œä¸Šä¸‹æ–‡é¢„è§ˆã€‚

## ğŸ—ï¸ å®ç°æ¶æ„

### 1. ç±»å‹å®šä¹‰ (`/src/types/index.ts`)

æ–°å¢äº†å®Œæ•´çš„æœç´¢ç›¸å…³ç±»å‹å®šä¹‰ï¼š

- **SearchRequest** - æœç´¢è¯·æ±‚å‚æ•°ç±»å‹
- **ConversationSearchResult** - å•ä¸ªæœç´¢ç»“æœç±»å‹
- **SearchResponse** - æœç´¢å“åº”ç±»å‹

### 2. æœåŠ¡æ¥å£ (`/src/services/interfaces/IConversationService.ts`)

åœ¨å¯¹è¯æœåŠ¡æ¥å£ä¸­æ–°å¢äº†æœç´¢æ–¹æ³•ï¼š

```typescript
searchConversations(request: SearchRequest): Promise<SearchResponse>;
```

### 3. APIæœåŠ¡å®ç° (`/src/services/api/ConversationApiService.ts`)

åœ¨ConversationApiServiceç±»ä¸­å®ç°äº†å…·ä½“çš„æœç´¢é€»è¾‘ï¼š

- æ„å»ºæŸ¥è¯¢å‚æ•°
- å‘é€GETè¯·æ±‚åˆ° `/api/conversations/search/conversations`
- é”™è¯¯å¤„ç†å’Œç±»å‹è½¬æ¢

### 4. è‡ªå®šä¹‰Hook (`/src/hooks/useConversationSearch.ts`)

åˆ›å»ºäº†ä¸“é—¨çš„æœç´¢Hookï¼Œæä¾›ï¼š

- **çŠ¶æ€ç®¡ç†**: æœç´¢ç»“æœã€åŠ è½½çŠ¶æ€ã€æŸ¥è¯¢å†å²
- **æ™ºèƒ½æ“ä½œ**: è‡ªåŠ¨åˆ†é¡µã€ç»“æœè¿½åŠ ã€çŠ¶æ€é‡ç½®
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯æç¤ºå’Œç”¨æˆ·åé¦ˆ
- **æ€§èƒ½ä¼˜åŒ–**: æ”¯æŒé˜²æŠ–å’Œç¼“å­˜

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### âœ… æ™ºèƒ½æœç´¢
- åŒæ—¶æœç´¢å¯¹è¯æ ‡é¢˜å’Œæ¶ˆæ¯å†…å®¹
- å¤§å°å†™ä¸æ•æ„ŸåŒ¹é…
- å®Œå…¨æ”¯æŒä¸­æ–‡æœç´¢

### âœ… ä¸Šä¸‹æ–‡é¢„è§ˆ
- æ˜¾ç¤ºåŒ¹é…ä½ç½®å‰å120ä¸ªå­—ç¬¦
- æ™ºèƒ½æ ‡è¯†åŒ¹é…æ¥æº ([æ ‡é¢˜], [ç”¨æˆ·], [åŠ©æ‰‹], [ç³»ç»Ÿ])
- è‡ªåŠ¨æ·»åŠ çœç•¥å·æ ‡ç¤ºæˆªæ–­

### âœ… åŒ¹é…ç»Ÿè®¡
- å‡†ç¡®è®¡ç®—æ¯ä¸ªå¯¹è¯çš„åŒ¹é…æ¬¡æ•°
- æŒ‰åŒ¹é…æ¬¡æ•°å’Œæ›´æ–°æ—¶é—´æ™ºèƒ½æ’åº

### âœ… åˆ†é¡µæ”¯æŒ
- æ”¯æŒåŠ è½½æ›´å¤šç»“æœ
- è‡ªåŠ¨è¿½åŠ æ–°ç»“æœåˆ°ç°æœ‰åˆ—è¡¨
- æ˜¾ç¤ºæ€»åŒ¹é…æ•°é‡

### âœ… ç”¨æˆ·ä½“éªŒ
- å®æ—¶æœç´¢çŠ¶æ€æç¤º
- è‡ªåŠ¨æ˜¾ç¤ºæœç´¢ç»“æœç»Ÿè®¡
- å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæç¤º
- æ”¯æŒæ¸…ç©ºå’Œé‡ç½®æ“ä½œ

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ç”¨æ³•

```typescript
import { useConversationSearch } from '@/hooks/useConversationSearch';

function SearchPage() {
  const {
    searchResults,
    totalCount,
    isSearching,
    searchConversations,
    resetSearch
  } = useConversationSearch();

  const handleSearch = (query: string) => {
    searchConversations(query);
  };

  return (
    <div>
      {/* æœç´¢ç•Œé¢å®ç° */}
    </div>
  );
}
```

### é«˜çº§ç”¨æ³•ï¼ˆå¸¦é˜²æŠ–ï¼‰

```typescript
const debouncedSearch = useDebounce(searchTerm, 500);

useEffect(() => {
  if (debouncedSearch.trim()) {
    searchConversations(debouncedSearch);
  }
}, [debouncedSearch]);
```

## ğŸ“¡ APIé›†æˆ

### åç«¯APIç«¯ç‚¹
```
GET /api/conversations/search/conversations?query=å…³é”®è¯&limit=20&offset=0
```

### è¯·æ±‚å‚æ•°
- `query`: æœç´¢å…³é”®è¯ (å¿…éœ€)
- `limit`: ç»“æœæ•°é‡é™åˆ¶ (å¯é€‰ï¼Œé»˜è®¤20)
- `offset`: åˆ†é¡µåç§»é‡ (å¯é€‰ï¼Œé»˜è®¤0)

### å“åº”æ ¼å¼
```json
{
  "results": [
    {
      "id": "conversation_id",
      "session_id": "session_id",
      "title": "å¯¹è¯æ ‡é¢˜",
      "match_count": 3,
      "context": "[ç”¨æˆ·] ...åŒ¹é…çš„ä¸Šä¸‹æ–‡...",
      "create_time": "2024-01-01T00:00:00Z",
      "update_time": "2024-01-01T00:00:00Z"
    }
  ],
  "total_count": 15,
  "query": "å…³é”®è¯"
}
```

## ğŸ” Hook APIè¯¦è§£

### çŠ¶æ€å±æ€§
- `searchResults`: æœç´¢ç»“æœæ•°ç»„
- `totalCount`: æ€»åŒ¹é…æ•°é‡  
- `currentQuery`: å½“å‰æœç´¢æŸ¥è¯¢
- `isSearching`: æœç´¢è¿›è¡Œä¸­çŠ¶æ€
- `hasSearched`: æ˜¯å¦å·²æœç´¢è¿‡

### æ“ä½œæ–¹æ³•
- `searchConversations(query, limit?, offset?)`: æ‰§è¡Œæœç´¢
- `clearResults()`: æ¸…ç©ºç»“æœ
- `resetSearch()`: é‡ç½®æ‰€æœ‰çŠ¶æ€

## ğŸ“ æ–‡ä»¶ç»“æ„

```
web/src/
â”œâ”€â”€ types/index.ts                    # æ–°å¢æœç´¢ç±»å‹å®šä¹‰
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ interfaces/
â”‚   â”‚   â””â”€â”€ IConversationService.ts   # æ–°å¢æœç´¢æ¥å£
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ ConversationApiService.ts # æ–°å¢æœç´¢å®ç°
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useConversationSearch.ts      # æ–°å¢æœç´¢Hook
â””â”€â”€ docs/
    â”œâ”€â”€ CONVERSATION_SEARCH_GUIDE.md  # ä½¿ç”¨æŒ‡å—
    â””â”€â”€ SEARCH_IMPLEMENTATION_SUMMARY.md # æœ¬æ–‡æ¡£
```

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

1. **UIç»„ä»¶**: åˆ›å»ºæœç´¢ç»„ä»¶ï¼Œé›†æˆåˆ°å¯¹è¯ç®¡ç†ç•Œé¢
2. **é˜²æŠ–ä¼˜åŒ–**: å®ç° `useDebounce` Hookï¼Œæå‡æœç´¢ä½“éªŒ
3. **é«˜äº®æ˜¾ç¤º**: åœ¨æœç´¢ç»“æœä¸­é«˜äº®åŒ¹é…çš„å…³é”®è¯
4. **å†å²è®°å½•**: ä¿å­˜ç”¨æˆ·çš„æœç´¢å†å²
5. **å¿«æ·é”®**: å®ç° Ctrl+F å…¨å±€æœç´¢å¿«æ·é”®

## âœ¨ æ€»ç»“

å®Œæ•´å®ç°äº†ç±»å‹å®‰å…¨ã€åŠŸèƒ½ä¸°å¯Œçš„å¯¹è¯æœç´¢ç³»ç»Ÿï¼š

- **ğŸ”§ å®Œæ•´çš„ç±»å‹å®šä¹‰** - ä¿è¯ç±»å‹å®‰å…¨
- **ğŸ“¡ æ ‡å‡†APIé›†æˆ** - ä¸åç«¯æ— ç¼å¯¹æ¥  
- **ğŸ¯ æ™ºèƒ½Hookå°è£…** - ç®€åŒ–ç»„ä»¶ä½¿ç”¨
- **ğŸ“š è¯¦å°½æ–‡æ¡£** - ä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **ğŸ¨ çµæ´»æ¶æ„** - æ˜“äºè‡ªå®šä¹‰å’Œä¼˜åŒ–

å‰ç«¯æœç´¢åŠŸèƒ½ç°å·²å°±ç»ªï¼Œå¯ä»¥ç›´æ¥åœ¨Reactç»„ä»¶ä¸­ä½¿ç”¨ï¼ğŸ‰ 